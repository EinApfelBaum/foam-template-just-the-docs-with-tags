{% capture site_tags %}{% for tag in site.tags %}{{ tag | first }}{% unless forloop.last %},{% endunless %}{% endfor
%}{% endcapture %}
{% assign tags_list = site_tags | split:',' | sort_natural %}

<div>
    <ul class="tags">
        {% for tag in tags_list %}

        <li> <a href="#{{ tag }}">{{ tag }}</a> </li>

        {% endfor %}

    </ul>
</div>

{% for item in (0..site.tags.size) %}{% unless forloop.last %}
{% capture this_word %}{{ tags_list[item] | strip_newlines }}{% endcapture %}
<article id="{{ this_word }}">
    <h2>{{ this_word }}</h2>
    <ul class="posts">
        {% for post in site.tags[this_word] %}{% if post.title != null %}
        <li><a href="{{ site.url }}{{ post.url | relative_url }}" title="{{ post.title }}">{{ post.title }}</a></li>
        {% endif %}{% endfor %}
    </ul>
</article>
{% endunless %}{% endfor %}
